# Multimodal Deep Belief Networks for Cancer Genomics
Implementation of our paper titled "Multimodal Deep Belief Networks for Prognostically Relevant Subtypes and Survival Prediction for Breast Cancer" submitted to European Conference on Machine Learning and Principles and Practice of Knowledge Discovery in Databases (aka. ECML-PKDD 2019).

In this implementation, both Deep Belief Networks (DBN) and multimodal Deep Belief Networks (mDBN) to predict the clinical status of breast cancer patients based on their genomics data. This mDBN model is trained with breast cancer genomics data from The Cancer Genome Atlas Breast Invasive Carcinoma (TCGA-BRCA). 

### Predicted clinical status ###
1. Breast cancer subtypes which is determined by the estrogen receptor (ER), progesterone receptor (PGR), and HER2/neu status
2. Survival rate (0-1, with 1 being the best chance of survival)

### Requirements ###
* Python 2 or Python 3
* Tensorflow and/or Theano.

### I. Download and create the dataset ###
* Open the terminal.
* Go to the main foler `cd mdbn_tcga_brca`.
* Run the dataset creation program `python3 main_download.py -d DATASET_IDX`.

| DATASET_IDX |                      Data Types                      | Space Requirements (GB) |
|------------:|:-----------------------------------------------------|:-----------------------:|
|           1 | DNA Methylation                                      |           148           |
|           2 | Gene Expression                                      |            9            |
|           3 | miRNA Expression                                     |           0.24          |
|           4 | Gene Expression + miRNA Expression                   |            10           |
|           5 | DNA Methylation + Gene Expression + miRNA Expression |           162           |

### II. Run the neural network ###
* Open the terminal.
* Go to the main foler `cd mdbn_tcga_brca`.
* Run the neural networks program `python main_run.py <options>`.

|               Option               |   Values   |                                                                                                                                                                                                                                                                                                                                                                                                              Details                                                                                                                                                                                            | Required |
|-----------------------------------:|:-----------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------:|
| -p PLATFORM<br>--platform PLATFORM | int [1-2]  | [1] Tensorflow, [2] Theano                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |    yes   |
|             -t TYPE<br>--type TYPE | int [1-2]  | [1] Breast cancer type classification<br>[2] Survival rate regression                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |    yes   |
|    -d DATASET<br>--dataset DATASET | int [1-15] | [1] DNA Methylation GPL8490<br>[2] DNA Methylation GPL16304<br>[3] Gene Expression Count<br>[4] Gene Expression FPKM<br>[5] Gene Expression FPKM-UQ<br>[6] miRNA Expression<br>[7] Gene Expression Count + miRNA Expression<br>[8] Gene Expression FPKM + miRNA Expression<br>[9] Gene Expression FPKM-UQ + miRNA Expression<br>[10] DNA Met GPL8490 + Gene Count + miRNA<br>[11] DNA Met GPL16304 + Gene Count + miRNA<br>[12] DNA Met GPL8490 + Gene FPKM + miRNA<br>[13] DNA Met GPL16304 + Gene FPKM + miRNA<br>[14] DNA Met GPL8490 + Gene FPKM-UQ + miRNA<br>[15] DNA Met GPL16304 + Gene FPKM-UQ + miRNA |    yes   |
|              --pretrain_epoch PRE_EPOCH | int        | Pre-training epoch. Default = 100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |    no    |
|          --train_epoch TRAIN_EPOCH | int        | Training epoch. Default = 100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |    no    |
|                      --batch BATCH | int        | Batch size for pre-training and training. Default = 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |    no    |
|                    --pre_lr PRE_LR | int        | Pre-training learning rate. Default = 0.01                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |    no    |
|                --train_lr TRAIN_LR | int        | Training learning rate. Default = 0.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |    no    |
|                  --dropout DROPOUT | int        | Dropout rate. Default = 0.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |    no    |
|                          --pca PCA | int [1-2]  | [1] Use PCA<br>[2] Don't use PCA<br>Default = [2] Don't use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |    no    |
|              --optimizer OPTIMIZER | int [1-3]  | [1] Stochastic gradient descent<br>[2] RMSProp<br>[3] Adam<br>Default = [1] Stochastic gradient descent                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |    no    |

### Special note ###
If you already have the processed datasets without running the `main_download.py`, please add `MAIN_MDBN_TCGA_BRCA = "main_datasets_folder"` on the first line of these two files:

* /mdbn_tcga_brca/Tensorflow/dataset_location.py
* /mdbn_tcga_brca/Theano/dataset_location.py

with `main_datasets_folder` being the main folder of your datasets.
